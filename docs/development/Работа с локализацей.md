**Добавление локализации**

Разместите ваш текст внутрь папки `public/locales/*.json`. Придерживайтесь двух правил: контекстный текст и переиспользуемый.

Контекстный может выглядеть так: "Вы забыли пароль?".
Переиспользуемый: "Да", "Нет", "Внимание!".

**Правила именования и структуры ключей**

1. **Ключи пишутся в camelCase** – (`"internalServiceError"`, `"loginPage"`).
2. **Иерархия выражается вложенными объектами**:
    - Для страниц используется схема `имяСтраницы.title` и, при необходимости, вложенный блок `text` (см. `homePage`, `notFoundPage` в `ru.json`).
    - Для форм, виджетов, сервисов и прочих компонентов используется `имяКомпонента` с вложенными объектами типа: `fields`, `errors`, `actions`, `text` (см. блок `organizationForm`).

3. **Общие действия и сообщения** хранятся в корневых разделах `actions`, `text`, `errors`.
4. **Внешние библиотеки** имеют собственный раздел – например, `primevue` содержит все строки для компонентов PrimeVue.
5. **Допустимы ключи с составными названиями** пример `"actions.backToHome"`.
6. **Для подстановок значений** используются фигурные скобки: `{name}`, `{validTo}` и позиционные `{0}`.

**Варианты применения локализации**

1. **Динамическая загрузка словарей** выполняется функцией `changeLocale`:

```JS
//src\service\app\localization.service.ts
export function detectUserLanguage(): string {
  return getLangFromUrl() || getLangFromLocalStorage() || getLangFromNavigator() || DEFAULT_LANG;
}
...
export async function changeLocale(locale: string) {
  const response = await fetch(`/locales/${locale}.json`);
  const messages = await response.json();
  i18n.global.setLocaleMessage(locale, messages);
}
```

2. **Установка заголовков страниц** через роутер:

```JS
//src\service\app\route.service.ts
export const setPageTitle = (to: RouteLocationNormalized) => {
  if (to.meta.titleKey) {
    document.title = t(to.meta.titleKey as string);
  }
};
...
  to.meta.title = t(to.meta.titleKey as string);
```

3. **Использование в сервисах** для сообщений об ошибках и шаблонов:

```JS
//src\service\auth\login.service.ts
try {
  const authToken = await auth(data);
  ...
} catch (err: unknown) {
  if (getHTTPErrorCode(err) === 401) {
    throw new Error(t('loginService.errors.incorrectLoginData'));
  }
}
```

```JS
//src\service\sign\certificate.service.ts
export const getLabel = (cert: Certificate) => {
  const name = cert.name;
  const validTo = cert.validTo;
  return t('certificateService.text.selectedCert', {
    name,
    validTo,
  });
};
```

4. **Использование в хранилищах (store)** – подписи для пунктов меню:

```JS
//src\store\profile\profile-popup.store.ts
state: () => ({
  menuItems: [
    {
      label: t('profileMenu.actions.choseCert'),
      ...
    },
    {
      label: t('actions.logout'),
      icon: 'pi pi-sign-out',
      command: confirmLogout,
    },
  ],
});
```

```JS
//src\store\app\sidebar-store.ts
state: (): SidebarStoreType => ({
  items: [
    { label: t('appSidebar.main'), to: getRoutePath(Routes.HOME), icon: 'pi pi-home' },
    {
      label: t('appSidebar.notifications'),
      to: getRoutePath(Routes.NOTIFICATIONS),
      ...
```

5. **Привязка словаря к PrimeVue**:

```JS
export const getPrimeVueConfig = () => {
  const currentLocale = i18n.global.locale.value;
  //Мы не знаем заранее, какие поля будут в локализации, поэтому приводим к Record
  const locale = i18n.global.getLocaleMessage(currentLocale) as Record<string, string>;
...
  const primevueMessages = locale.primevue;
...
  return {
    theme: { preset: SpimexPreset },
    locale: primevueMessages,
  };
};
```

6. **В компонентах Vue** – через глобальный `$t`:

```VUE
<div class="error-message">
  <p>{{ $t('notFoundPage.text.description') }}</p>
  <Button @click="pushPage(Routes.HOME)" :label="$t('actions.backToHome')" />
</div>
```

```VUE
<label for="shouldSign">
  {{ $t('signCheckbox.text.withSign') }}
  ...
  (<u> {{ $t('signCheckbox.actions.selectCertificate') }} </u>)
</label>
```

**Итого**

- **Локализация хранится** в `public/locales/<lang>.json`.
- **Ключи** формируются в camelCase, группируются по областям: общие `actions`, `text`, `errors`; страницы вида `namePage`; блоки компонентов с `fields`, `fieldset`, `errors`, `actions`.
- **Переменные** в строках указываются в фигурных скобках.
- **Использование** в шаблонах Vue (`$t('key')`), в *.ts файлах через `t`, при установке заголовка страницы и для передачи переводов библиотеке PrimeVue.

